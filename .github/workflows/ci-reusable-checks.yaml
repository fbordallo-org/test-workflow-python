
---
name: ðŸ› ï¸ CI Reusable Checks

on:
  workflow_call:
    inputs:
      super-linter:
        description: Whether to run super-linter (slim mode)
        required: false
        default: false
        type: boolean
      
      super-linter-full:
        description: Whether to run super-linter (full mode)
        required: false
        default: false
        type: boolean

      super-linter-env:
        description: Environment variables to pass to super-linter
        required: false
        # Env file format:
        #   VALIDATE_CHECKOV=true
        #   VALIDATE_PYTHON=true
        default: ''
        type: string
      
jobs:
  super-linter:
    if: ${{ inputs.super-linter }}
    runs-on: ubuntu-24.04
    permissions:
      contents: read
      packages: read
      statuses: write
    steps:
      - name: Checkout
        uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
        with:
          fetch-depth: 0
          persist-credentials: false

      - name: Set environment variables for Super-linter
        id: set-env
        run: |
          echo "GITHUB_TOKEN=$GITHUB_TOKEN" >> "$GITHUB_ENV"
          echo "$SUPER_LINTER_ENV" >> "$GITHUB_ENV"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          SUPER_LINTER_ENV: ${{ inputs.super-linter-env }}

      - name: Super-linter
        uses: super-linter/super-linter/slim@47984f49b4e87383eed97890fe2dca6063bbd9c3 # v8.3.1

  super-linter-full:
    if: ${{ inputs.super-linter-full }}
    runs-on: ubuntu-24.04
    permissions:
      contents: read
      packages: read
      statuses: write
    steps:
      - name: Checkout
        uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
        with:
          fetch-depth: 0
          persist-credentials: false

      - name: Set environment variables for Super-linter
        id: set-env
        run: |
          echo "GITHUB_TOKEN=$GITHUB_TOKEN" >> "$GITHUB_ENV"
          echo "$SUPER_LINTER_ENV" >> "$GITHUB_ENV"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          SUPER_LINTER_ENV: ${{ inputs.super-linter-env }}

      - name: Super-linter
        uses: super-linter/super-linter@47984f49b4e87383eed97890fe2dca6063bbd9c3 # v8.3.1